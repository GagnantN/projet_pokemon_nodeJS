<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <title>Créer un pokemon</title>
    </head>
    <body>

        <h2>Créer un pokémon</h2>

        <form id="fleurForm">
            <label>Nom :</label><br>
            <input type="text" id="name" required><br><br>

            <label>Couleur :</label><br>
            <input type="text" id="color" required><br><br>

            <label>Prix :</label><br>
            <input type="number" id="price" required><br><br>

            <button type="submit">Créer la fleur</button>
        </form>

        <div id="result"></div>

        <script>
            const form = document.getElementById('fleurForm');

            form.addEventListener('submit', async (e) => {
                e.preventDefault(); // On utilise preventDefault() pour empecher le rechargement de la page afin d'afficher les données intégrées

                // Ici on reconstruit un objet de type Fleur avec les données du formulaire
                const data = {
                    name: document.getElementById('name').value,
                    color: document.getElementById('color').value,
                    price: Number(document.getElementById('price').value)
                };

                // Ici on envoie la requête au serveur en utilisant fetch
                // On utilise la methode POST car on veut créer une nouvelle fleur
                try {
                    const response = await fetch('http://localhost:3000/api/fleurs', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data) // On met les données dans le format JSON
                    });

                    // Ici on récupère la réponse du serveur qu'on affiche sous forme de text
                    const result = await response.json();
                    document.getElementById('result').innerText =
                        "Réponse serveur : " + JSON.stringify(result, null, 2);

                } catch (error) {
                    console.error("Erreur :", error);
                }
            });
        </script>

    </body>
</html>